{php}
    $disabled = isset($writablefields) && count($writablefields) ? (array_key_exists($field['name'], $writablefields) ? '' : 'disabled') : '';
    $show_audit_value = $show_audit_value ?? 0;
    $isinput = (app('request')->action()=='view' && $show_audit_value==1) ? 1 : 0;
    if (app('request')->action()!='view') {
        $data['id'] = $id ?? '';  
        $data[$field['name']] = $data[$field['name']] ?? '';
        $data[$field['name']] = isset($writablefields[$field['name']]) ? $writablefields[$field['name']] : $data[$field['name']];
    }
{/php}

{if condition="($field['extra'] eq 'first') and ($field['type'] eq 'liandong') "}
    <script>
        $(function () {
            var dataCustom = eval("(" + $(".liandong3").attr("data-text") + ")");
            $('.liandong3').cxSelect({
                selects: ['first', 'second', 'third', 'fourth', 'last'],
                jsonValue: 'v',
                data: dataCustom
            });
        });
    </script>
    <div class="mt-repeater-input liandong3" data-text='{:parse_function_field($field[' execute'])}'>
{/if}
        <div class="form-group {empty name="field.tr_class"}col-md-12 {else /}$field['tr_class']{/empty}{php}if ($field['isshow']==5) {echo 'auditfield' ; } {/php}" data-field-type="{$field.type}" {php} if(($isinput && !$data[$field['name']]) || (!$isinput &&$field['is_hidden']==1)) { echo 'style="display:none;"' ; } {/php} id="field-{$field.id}" {notempty name="field.linkage" } data-linkage-value="{$field['linkage'][0]}" data-linkage-field="{$field['linkage'][1]}"{/notempty}>
            <label class="control-label col-md-3">{$field['title']}{eq name="field.ismust" value="1"}<span class="required">* </span>{/eq}</label>
            <div class="col-md-8">
                {php}$action = ((app('request')->action()=='audit' && $disabled=='disabled') || app('request')->action()=='view') ? 1 : 2;{/php}
                {eq name="action" value="1"}
                    {php}
                        $value = valueByFieldData($data[$field['name']], $field, array(), $data);
                        echo ($value || trim($value)!='') ? $value : " &nbsp;";
                        if ($field['linkview']) {
                            $linkview = $field['linkview'];
                            $url = str_replace('$work_id',$data[$field['name']],$linkview['url']);
                            $url = handleAttributeValue($url, $data);
                            $url = str_replace('{',"",$url);
                            $url = str_replace('}',"",$url);
                            $width = $linkview['width'] ? $linkview['width'] : 900;
                            if ($linkview['type']=='partmodal') {
                                echo ' <a style="padding-top:0;padding-bottom: 0;" data-url="'.U($url).' #index-body" data-id="dialog-mask-views" data-width="'.$width.'" data-toggle="partmodal" class="btn btn-sm btn-primary"><i class="fa fa-search"></i> '.$linkview['name'].'</a>';
                            } else {
                                echo ' <a style="padding-top:0;padding-bottom: 0;" data-url="'.U($url).'" data-id="dialog-mask-view" data-width="'.$width.'" data-toggle="modal" class="btn btn-sm btn-primary"><i class="fa fa-search"></i>'.$linkview['name'].'</a>';
                            }
                        }
                    {/php}
                    <div style="display: none">
                {/eq}
                    {empty name="isinput"}
                        {switch name="field.type"}
                            {case value="table"}
                                <select name="{$field.name}" class="form-control {eq name="field.ismust" value="1"}required{/eq}" {$disabled} >
                                    <option></option>
                                    {volist name=":parse_table_field($field['extra'],$data)" id="vo"}
                                        <option value="{$key}" {eq name="data[$field['name']]" value="$key"}selected{/eq}>{$vo}</option>
                                    {/volist}
                                </select>
                            {/case}
                            {case value="linktable"}
                                <select data-extra="{:handleAttributeValue($field['extra'],$data)}" data-jsfunc="{$field['jsfunc']}" class="form-control js-data-example-ajax {eq name="field.ismust" value="1"}required{/eq}" name="{$field.name} {eq name="field.is_multiple" value="1"}[]{/eq}" {eq name="field.is_multiple" value="1"}multiple{/eq} {$disabled} >
                                    {php}
                                        //选择多个处理
                                        if ($field['is_multiple']==1) {
                                            $keys = $data[$field['name']] ? str2arr($data[$field['name']]) : array();
                                            if ($keys) {
                                                foreach ($keys as $key) {
                                                    $value = linktableValue($key, $field['extra']);
                                                    echo '<option value="'.$key.'" selected="selected">'.$value.'</option>';
                                                }
                                            }
                                        } else {
                                            if ($field['is_inherit']==1 && !$field['value']) {
                                                $field['value'] = inheritAttributeValue($pre_process_id, $work_id, $field);
                                            }
                                            $key = $data[$field['name']] ?? $field['value'];
                                            if ($key) {
                                                $value = linktableValue($key, $field['extra']);
                                                echo '<option value="'.$key.'" selected="selected">'.$value.'</option>';
                                            }
                                        }
                                    {/php}
                                </select>
                            {/case}
                            {case value="function"}
                                <select name="{$field.name}" class="form-control select2me {eq name="field.ismust" value="1"}required{/eq}" {$disabled} >
                                    <option></option>
                                    {volist name=":parse_function_field($field['execute'],$data)" id="vo"}
                                        <option value="{$key}" {eq name="data[$field['name']]" value="$key"}selected{/eq}>{$vo}</option>
                                    {/volist}
                                </select>
                            {/case}
                            {case value="select"}
                                <select class="form-control select2me {eq name="field.ismust" value="1"}required{/eq}" data-jsfunc="{$field['jsfunc']}" name="{$field.name}" {$disabled} >
                                    <option></option>
                                    {volist name=":parse_field_attr($field['extra'])" id="vo"}
                                        <option value="{$key}" {notempty name="data[$field['name']]"}{eq name="data[$field['name']]" value="$key"}selected{/eq}{else /}{eq name="field.value" value="$key"}selected{/eq}{/notempty}>{$vo}</option>
                                    {/volist}
                                </select>
                            {/case}
                            {case value="liandong"}
                                <select name="{$field.name}" class="form-control {$field.extra}" data-value="{php}echo $data[$field['name']] ?? $field['value'];{/php}"></select>
                            {/case}
                            {case value="radio"}
                                <div class="mt-radio-inline {eq name="field.ismust" value="1"}required{/eq}">
                                    {volist name=":parse_field_attr($field['extra'])" id="vo"}
                                        <label class="mt-radio">
                                            <input class="{eq name="field.ismust" value="1"}required{/eq}" {$disabled} type="radio" name="{$field.name}" value="{$key}" {notempty name="data[$field['name']]"}{eq name="data[$field['name']]" value="$key"}checked="checked"{/eq}{else /}{eq name="field.value" value="$key"}checked{/eq}{/notempty}>{$vo}
                                            <span></span>
                                        </label>
                                    {/volist}
                                </div>
                            {/case}
                            {case value="checkbox"}
                                <div class="mt-checkbox-inline" style="padding: 0;">
                                    {php}
                                        //excute有值则优先处理使用
                                        $cdata = $field['execute'] ? parse_table_field($field['execute'],$data) : parse_field_attr($field['extra']);
                                    {/php}
                                    {volist name="cdata" id="vo"}
                                        <label class="mt-checkbox">
                                            <input type="checkbox" value="{$key}" name="{$field.name}[]" {if condition="check_document_position($data[$field['name']],$key)"}checked="checked"{/if}>{$vo}
                                            <span></span>
                                        </label>
                                    {/volist}
                                </div>
                            {/case}
                            {case value="textarea"}
                                <textarea name="{$field.name}" class="form-control {eq name="field.ismust" value="1"}required{/eq}" rows="3" {$disabled} >{$data[$field['name']]}</textarea>
                            {/case}
                            {case value="date"}
                                <input name="{$field.name}" class="form-control date-picker {eq name="field.ismust" value="1"}required{/eq}" type="text" value="{if condition="$data[$field['name']]"} $data[$field['name']]|date='Y-m-d',### {/if}" placeholder="请选择日期" readonly='true' data-date-format="yyyy-mm-dd" />
                            {/case}
                            {case value="datem"}
                                <input name="{$field.name}" class="form-control date-picker {eq name="field.ismust" value="1"}required{/eq}" type="text" value="{if condition="$data[$field['name']]"} $data[$field['name']]|date='Y-m',### {/if}" placeholder="请选择月份" readonly='true' data-date-format="yyyy-mm" />
                            {/case}
                            {case value="datetime"}
                                <input {$disabled} class="input-group form-control form-control-inline date datetime-picker {eq name="field.ismust" value="1"}required{/eq}" type="text" value="{if condition="$data[$field['name']]"} {php}echo date('Y-m-d H:i', $data[$field['name']]);{/php} {/if}" name="{$field.name}" readonly='true' />
                            {/case}
                            {case value="daterange"}
                                <div class="input-group input-large date-picker input-daterange" data-date="2017-1-1" data-date-format="yyyy-mm-dd">
                                    <input type="text" class="form-control {eq name="field.ismust" value="1"}required{/eq}" name="timefrom" value="{notempty name="data.timefrom"} $data['timefrom']|date='Y-m-d',### {/notempty}" {$disabled} readonly='true'>
                                    <span class="input-group-addon"> 到 </span>
                                    <input type="text" class="form-control {eq name="field.ismust" value="1"}required{/eq}" name="timeto" value="{notempty name="data.timeto"} $data['timeto']|date='Y-m-d',### {/notempty}" {$disabled} readonly='true'> 
                                </div>
                            {/case}
                            {case value="daterangetime"}
                                <div class="input-group date datetime-picker"  style="width:200px; float:left;">
                                    <input type="text" class="form-control change_time_1 {eq name="field.ismust" value="1"}required{/eq}" name="timefrom" value="{notempty name="data.timefrom"} $data['timefrom']|date='Y-m-d H:i',### {/notempty}" {$disabled} readonly='true'>
                                    <span class="input-group-btn">
                                        <button class="btn default date-set" type="button">
                                            <i class="fa fa-calendar"></i>
                                        </button>
                                    </span>
                                </div>
                                <span style="float:left; width:39px; height:34px; text-align:center; line-height:34px;">到</span>
                                <div class="input-group date datetime-picker" style="width:200px; float:left;">
                                    <input type="text" class="form-control change_time_2 {eq name="field.ismust" value="1"}required{/eq}" name="timeto" value="{notempty name="data.timeto"} $data['timeto']|date='Y-m-d H:i',### {/notempty}" {$disabled} readonly='true'>
                                    <span class="input-group-btn">
                                        <button class="btn default date-set" type="button">
                                            <i class="fa fa-calendar"></i>
                                        </button>
                                    </span>
                                </div>
                                <span class="help-block change_time_3" style="display:none;color:#f00;float:left;margin-left:20px;">警告：结束时间必须要大于开始时间！</span>
                                
                                <!-- 
                                    不知道为什么会报错~
                                    load href="__FRAME__/global/plugins/bootstrap-datetimepicker/js/bootstrap-datetimepicker.js"
                                    load href="__JS__/attribute_daterangetime.js" 
                                -->
                                
                                <script type="text/javascript" src="/static/assets/global/plugins/bootstrap-datetimepicker/js/bootstrap-datetimepicker.js"></script>
                                <script type="text/javascript">
                                    $(function () {
                                        $(".datetime-picker").click(function () {
                                            $(".fa-angle-left").show();
                                            $(".fa-angle-right").show();
                                            $(".prevno").attr("class", "prev");
                                            $(".nextno").attr("class", "next");
                                        })
                                        $(".change_time_1, .change_time_2").change(function () {
                                            var ayears = $(".datetimepicker").eq(0).children(".datetimepicker-years").find(".active").text();
                                            var amonths = $(".datetimepicker").eq(0).children(".datetimepicker-months").find(".active").text();
                                            if (amonths == "Jan") { amonths = 1 } else { if (amonths == "Feb") { amonths = 2 } else { if (amonths == "Mar") { amonths = 3 } else { if (amonths == "Apr") { amonths = 4 } else { if (amonths == "May") { amonths = 5 } else { if (amonths == "Jun") { amonths = 6 } else { if (amonths == "Jul") { amonths = 7 } else { if (amonths == "Aug") { amonths = 8 } else { if (amonths == "Sep") { amonths = 9 } else { if (amonths == "Oct") { amonths = 10 } else { if (amonths == "Nov") { amonths = 11 } else { if (amonths == "Dec") { amonths = 12 } } } } } } } } } } } };
                                            var adays = $(".datetimepicker").eq(0).children(".datetimepicker-days").find(".active").text();
                                            var ahours = $(".datetimepicker").eq(0).children(".datetimepicker-hours").find(".active").text();
                                            var aminutes = $(".datetimepicker").eq(0).children(".datetimepicker-minutes").find(".active").text();
                                    
                                            var byears = $(".datetimepicker").eq(1).children(".datetimepicker-years").find(".active").text();
                                            var bmonths = $(".datetimepicker").eq(1).children(".datetimepicker-months").find(".active").text();
                                            if (bmonths == "Jan") { bmonths = 1 } else { if (bmonths == "Feb") { bmonths = 2 } else { if (bmonths == "Mar") { bmonths = 3 } else { if (bmonths == "Apr") { bmonths = 4 } else { if (bmonths == "May") { bmonths = 5 } else { if (bmonths == "Jun") { bmonths = 6 } else { if (bmonths == "Jul") { bmonths = 7 } else { if (bmonths == "Aug") { bmonths = 8 } else { if (bmonths == "Sep") { bmonths = 9 } else { if (bmonths == "Oct") { bmonths = 10 } else { if (bmonths == "Nov") { bmonths = 11 } else { if (bmonths == "Dec") { bmonths = 12 } } } } } } } } } } } };
                                            var bdays = $(".datetimepicker").eq(1).children(".datetimepicker-days").find(".active").text();
                                            var bhours = $(".datetimepicker").eq(1).children(".datetimepicker-hours").find(".active").text();
                                            var bminutes = $(".datetimepicker").eq(1).children(".datetimepicker-minutes").find(".active").text();
                                            if (adays < 10) { adays = '0' + adays; }
                                            if (bdays < 10) { bdays = '0' + bdays; }
                                            if (aminutes.slice(0, 1) > 1) { aminutes = '0' + aminutes; }
                                            if (bminutes.slice(0, 1) > 1) { bminutes = '0' + bminutes; }
                                            atime = ayears + amonths + adays + aminutes;
                                            btime = byears + bmonths + bdays + bminutes;
                                    
                                            if (btime < atime || btime == atime) {
                                                $(".change_time_3").css("display", "block");
                                            } else {
                                                $(".change_time_3").css("display", "none");
                                            }
                                        })
                                    })
                                </script>
                            {/case}
                            {case value="department"}
                                <span class="dep_b_span">
                                    <span data_id="{php}echo $data[$field['name']] ?? '';{/php}" data_pid="" class="depSpan search-tree-input"></span>
                                </span>
                                <input name="{$field.name}" type="hidden" value="{php}echo $data[$field['name']];{/php}" class="form-control search-tree-id {eq name="field.ismust" value="1"}required{/eq}" />
                                <span class="input-group-btn">
                                    <button class="btn default date-range-toggle search-tree-close" type="button">
                                        <i class="fa fa-close"></i>
                                    </button>
                                </span>
                                <div class="search-tree-box">
                                    <div class="portlet-body">
                                        <div class="tree_4 tree-demo"> </div>
                                    </div>
                                </div>
                                <script>
                                    var dep_url="__APP__/Public/getDepList";
                                    $(function(){
                                        depSelector(dep_url);
                                    });
                                </script>
                            {/case}
                            {case value="editor"}
                                <label class="textarea">
                                    <script id="{$field.name}{$data['id']}" name="{$field.name}" type="text/plain">{$data[$field['name']]}</script>
                                </label>
                                <!-- 实例化编辑器 -->
                                {notempty name="disabled"}
                                    <script type="text/javascript">
                                        var ue = UE.getEditor("{$field.name}{$data['id']}",{
                                            readonly:true
                                        });
                                    </script>
                                {else /}
                                    <script type="text/javascript">
                                        var ue = UE.getEditor("{$field.name}{$data['id']}");
                                    </script>
                                {/notempty}
                            {/case}
                            {case value="file"}
                                <div class="controls">
                                    {empty name="disabled"}
                                        <input id="upload_file_{$field.name}" name="fileinput" data-show-preview="false" type="file" />
                                    {/empty}
                                    <input type="hidden" name="{$field.name}" value="{php}if($data[$field['name']]) echo $data[$field['name']];{/php}" class="{eq name="field.ismust" value="1"}required{/eq} {eq name="field.is_hidden" value="1"}ignore{/eq}" />
                                    <div class="upload-img-box">
                                        {notempty name="data[$field['name']]"}
                                            {php}
                                                $file = get_table_field($data[$field['name']], 'id', '', 'File');
                                            {/php}
                                            <div class="upload-pre-file"><i class='fa fa-paperclip'></i> <a target='_blank' href='{$file.url}'>{$file.name}</a></div>
                                        {/notempty}
                                    </div>
                                </div>
                                <script type="text/javascript">
                                    $(document).on('ready', function () {
                                        //初始化
                                        $("#upload_file_{$field.name}").fileinput({
                                            language: 'zh', //设置语言
                                            browseIcon: '<i class="glyphicon glyphicon-open"></i>&nbsp;', //单文件图标
                                            uploadUrl: "/File/upload_fileinput", //上传的地址
                                            allowedFileExtensions: ['rar', 'tar', 'gz', '7z', 'txt', 'zip', 'jpeg', 'jpg', 'gif', 'png', 'xls', 'xls', 'xlsx', 'doc', 'docx', 'mp3', 'wav'],//接收的文件后缀
                                            uploadAsync: true, //默认异步上传
                                            showUpload: true, //是否显示上传按钮
                                            showRemove: false, //显示移除按钮
                                            showPreview: true, //是否显示预览
                                            showCaption: false,//是否显示标题
                                            browseClass: "btn btn-primary", //按钮样式    
                                            dropZoneEnabled: false,//是否显示拖拽区域
                                            maxFileCount: 10, //表示允许同时上传的最大文件个数
                                            enctype: 'multipart/form-data',
                                            validateInitialCount: true,
                                            previewFileIcon: "<iclass='glyphicon glyphicon-king'></i>",
                                            msgFilesTooMany: "选择上传的文件数量({n}) 超过允许的最大数值{m}！",
                                        }).on("filebatchselected", function (event, files) {
                                            $(this).fileinput("upload");
                                        }).on("fileuploaded", function (event, data, previewId, index) {  //event,data,previewId,index
                                            var file_id = data.response.fileid;//id
                                            var file_name = data.response.info;//name
                                            var file_url = data.response.url;//url
                                            var name = "{$field.name}";
                                            if ("undefined" != typeof file_id) {
                                                $("input[name=" + name + "]").val(file_id);
                                                $("input[name=" + name + "]").parent().find('.upload-img-box').html(
                                                    "<div class=\"upload-pre-file\"><i class='fa fa-paperclip'></i> <a target='_blank' href='" + file_url + "'> " + file_name + "</a></div>"
                                                );
                                            } else {
                                                alert("文件上传错误，请检查后再重新上传！");
                                            }
                                        });
                                    });
                                </script>
                            {/case}
                            {case value="multifile"}
                                <div class="controls">
                                    {empty name="disabled"}
                                        <input id="upload_file_{$field.name}" name="fileinput" data-show-preview="false" type="file" multiple/>
                                    {/empty}
                                    <input type="hidden" name="{$field.name}" value="{php}if($data[$field['name']]) echo $data[$field['name']];{/php}" class="{eq name="field.ismust" value="1"}required{/eq} {eq name="field.is_hidden" value="1"}ignore{/eq}"/>
                                    <input type="hidden" date_name="{$field.name}"/>
                                    <div class="upload-img-box">
                                        {notempty name="data[$field['name']]"}
                                            {php}
                                                $where = 'id in ('.$data[$field['name']].')';
                                                $file = think\facade\Db::name('file')->where($where)->select()->toArray();
                                                $filecount = count($file);
                                            {/php}
                                            <input class="eidtid" type="hidden" value="{$id}">
                                            {for start="0" end="$filecount"}
                                                <div class="upload-pre-file">
                                                    <input class="re" type="hidden" name="{$field.name}[]" value='{$file[$i]["id"]}'/>
                                                    <i class='fa fa-paperclip'></i> 
                                                    <a class="w_text" target='_blank' href='{$file[$i]["url"]}'>{$file[$i]["name"]}</a>
                                                    <a class="right_b">
                                                        <i class="fa fa-ban"> 删除</i>
                                                    </a>
                                                    &nbsp;
                                                    <span class="sid">{$file[$i]["id"]}</span>
                                                </div>
                                            {/for}
                                         {/notempty}
                                    </div>
                                </div>
                                <script type="text/javascript">
                                $(document).on('ready', function () {
                                    //初始化
                                    $("#upload_file_{$field.name}").fileinput({
                                        language: 'zh', //设置语言
                                        browseIcon: '<i class="glyphicon glyphicon-folder-open"></i>&nbsp;', //多文件图标
                                        uploadUrl: "/File/upload_fileinput", //上传的地址
                                        allowedFileExtensions: ['rar', 'tar', 'gz', '7z', 'txt', 'zip', 'jpeg', 'jpg', 'gif', 'png', 'xls', 'xls', 'xlsx', 'doc', 'docx', 'mp3', 'wav'],//接收的文件后缀
                                        uploadAsync: true, //默认异步上传
                                        showUpload: true, //是否显示上传按钮
                                        showRemove: false, //显示移除按钮
                                        showPreview: true, //是否显示预览
                                        showCaption: false,//是否显示标题
                                        browseClass: "btn btn-primary", //按钮样式    
                                        dropZoneEnabled: false,//是否显示拖拽区域
                                        maxFileCount: 10, //表示允许同时上传的最大文件个数
                                        enctype: 'multipart/form-data',
                                        validateInitialCount: true,
                                        previewFileIcon: "<iclass='glyphicon glyphicon-king'></i>",
                                        msgFilesTooMany: "选择上传的文件数量({n}) 超过允许的最大数值{m}！",
                                    }).on("filebatchselected", function (event, files) {
                                        $(this).fileinput("upload");
                                    }).on("fileuploaded", function (event, data, previewId, index) {  //event,data,previewId,index
                                        var file_id = data.response.fileid;//id
                                        var file_name = data.response.info;//name
                                        var file_url = data.response.url;//url
                                        var name = "{$field.name}";
                                        if ("undefined" != typeof file_id) {
                                            $("input[name=" + name + "]").remove();
                                            $("input[date_name=" + name + "]").parent(".controls").children(".upload-img-box").append('<div class="upload-pre-file"><input class="re" type="hidden" name="' + name + '[]" value="' + file_id + '"/><i class="fa fa-paperclip"></i> <a target="_blank" href="' + file_url + '">' + file_name + '</a><a class="right_a"><i class="fa fa-ban"> 删除</i></a></div>');
                                        } else {
                                            alert("文件上传错误，请检查后再重新上传！");
                                        }
                                    });
                                    //多文件删除
                                    $(document).on('click', '.right_a', function () {
                                        $(this).parent("div").remove();
                                        $(this).parent("div").prev(".re").remove();
                                    })
                                });

                                //编辑的时候修改
                                $(document).on('click', '.right_b', function () {
                                    $(this).parent("div").remove();
                                    $(this).parent("div").prev(".re").remove();
                                })
                            </script>
                            {/case}
                            {case value="grade"}
                                <eq name="isinput" value="0">
                                    <style type="text/css">
                                        .glyphicon-star-empty{font-size:25px; margin-right:10px; color:#999; cursor:pointer;}
                                        .glyphicon-star{font-size:25px; margin-right:10px; color:#f00; cursor:pointer;}
                                        .z_info{height:20px; line-height:20px; text-align:center; position:absolute; left:-27px; top:-27px; background:#666; font-size:12px; color:#fff; z-index:10; display:none;}
                                    </style>
                                    <script type="text/javascript">
                                        $(document).on('ready', function () {
                                            //编辑模式
                                            $("input[grade='e']").each(function () {
                                                var name = $(this).attr("name");
                                                var val = $(this).val();
                                                if (val) {
                                                    var k = val;
                                                    var obj = $("span[grade='" + name + "']span[key='" + k + "']");
                                                    obj.prevAll('.glyphicon-star-empty').attr("class", "glyphicon glyphicon-star");
                                                    obj.attr("class", "glyphicon glyphicon-star");
                                                }
                                            })
                                        })
                                        //点选空星
                                        $(document).on('click', 'span[grade="{$field.name}"].glyphicon-star-empty', function () {
                                            var name = '{$field.name}';
                                            var key = $(this).attr("key");
                                            $("input[name={$field.name}]").val(key);
                                            $(this).prevAll('.glyphicon-star-empty').attr("class", "glyphicon glyphicon-star");
                                            $(this).attr("class", "glyphicon glyphicon-star");
                                        })
                                        //点选实星
                                        $(document).on('click', 'span[grade="{$field.name}"].glyphicon-star', function () {
                                            var name = '{$field.name}';
                                            var key = $(this).attr("key");
                                            $("input[name={$field.name}]").val(key);
                                            $(this).nextAll('.glyphicon-star').attr("class", "glyphicon glyphicon-star-empty");
                                        })
                                        //提示
                                        $(document).on('mouseover', 'span[grade="{$field.name}"]', function () {
                                            $(this).children(".z_info").show();
                                        });
                                        $(document).on('mouseout', 'span[grade="{$field.name}"]', function () {
                                            $(this).children(".z_info").hide();
                                        });
                                    </script>
                                    {php}
                                        $fields1 = explode('|', $field['extra']);
                                        foreach ($fields1 as $val) {
                                            $val = explode(':',$val);
                                            $echo = "<span grade='".$field["name"]."' key='$val[0]' class='glyphicon glyphicon-star-empty'>";
                                            $fields2 = explode('|', $field['execute']);
                                            foreach ($fields2 as $v2) {
                                                $val2 = explode(':',$v2);
                                                if ($val2[0]==$val[0]) {
                                                    $width = strlen($val2[1]);
                                                    $width = ($width*5).'px';
                                                    $echo .= "<span style='width:$width' class='z_info'>$val2[1]</span>";
                                                }
                                            }
                                            $echo .= "</span>";
                                            echo $echo;
                                        }
                                    {/php}
                                    <input grade="e" type="hidden" name="{$field.name}" value="{php}if($data[$field['name']]) echo $data[$field['name']];{/php}" class="{eq name="field.ismust" value="1"}required{/eq} {eq name="field.is_hidden" value="1"}ignore{/eq}" />
                                {/eq}
                            {/case}
                            {case value="labeltext"}
                                <style type="text/css">
                                    .binfo{margin-right:8px; margin-bottom:8px;}
                                </style>
                                <script type="text/javascript">
                                    $(document).on('click', '.binfo', function () {
                                        var text = $(this).val();
                                        var oldtext = $("textarea[name={$field.name}]").val();
                                        text = oldtext + text + ",";
                                        $("textarea[name={$field.name}]").val(text);
                                        $(this).hide();
                                    })
                                </script>
                                {php}
                                    $fields1 = explode('|', $field['extra']);
                                    foreach ($fields1 as $val) {
                                        $val = explode(':',$val);
                                        echo "<input type='button' class='binfo btn default' value='$val[1]'>";
                                    }
                                {/php}
                                <textarea name="{$field.name}" class="form-control {eq name="field.ismust" value="1"}required{/eq}" rows="3" {$disabled}>{$data[$field['name']]}</textarea>
                            {/case}
                            {default /}
                            <input type="text" placeholder="" name="{$field.name}" class="form-control {eq name="field.ismust" value="1"}required{/eq}{eq name="field.is_hidden" value="1"}ignore{/eq}" value="{php}echo ($data[$field['name']] || trim($data[$field['name']])!='') ? $data[$field['name']] : $field['value'];{/php}" {$disabled} />
                        {/switch}
                        <span class="help-block" id="{$field.name}-label">
                            {notempty name="field['remark']"}（{$field['remark']}）{/notempty}
                        </span>
                    {/empty}
                {eq name="action" value="1"}
                    </div>
                {/eq}
                <span class="help-block label-infos"></span>
            </div>
        </div>
{if condition="($field['label_class'] eq 'last') and ($field['type'] eq 'liandong') "}
    </div>
{/if}